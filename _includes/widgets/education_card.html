<div class="row mt-3">
  <div class="col-12">
    <div class="card border-0 shadow-sm bg-white rounded-xl">
      <div class="card-body p-4">
        <h6 class="mb-4 font-weight-semibold text-primary-700 d-flex align-items-center education-heading">
          Education
        </h6>
        <ul class="list-unstyled">
          {% for item in site.data.profile.education %}
          <li class="d-flex mb-4 align-items-center">
            <img src="{{ item.logo | relative_url }}" alt="{{ item.name }}" class="w-16 h-16 object-contain mr-4" loading="lazy" style="filter: brightness(0.9);">
            <div class="flex-grow-1">
              <div class="d-flex justify-content-between align-items-start flex-wrap">
                <div>
                  {% comment %} 学校名称 {% endcomment %}
                  <h5 class="mt-0 mb-1 font-weight-bold">
                    {% if item.url %}
                      <a href="{{ item.url | strip }}" class="education-link">{{ item.name }}</a>
                    {% else %}
                      {{ item.name }}
                    {% endif %}
                  </h5>

                  {% comment %} 实验室信息 - 修复了注释和空值问题 {% endcomment %}
                  {% if item.lab %}
                    {% comment %} 处理lab可能是对象或字符串的情况 {% endcomment %}
                    {% if item.lab.name %}
                      {% assign lab_name = item.lab.name %}
                      {% assign lab_url = item.lab.url | default: "" %}
                    {% else %}
                      {% assign lab_name = item.lab %}
                      {% assign lab_url = "" %}
                    {% endif %}

                    {% if lab_name != empty and lab_name != "none" %}
                      <div class="text-gray-700 mb-1">
                        {% if lab_url != empty and lab_url != "none" and lab_url != empty %}
                          <a href="{{ lab_url | strip }}" class="education-link">{{ lab_name | strip }}</a>
                        {% else %}
                          {{ lab_name | strip }}
                        {% endif %}
                      </div>
                    {% endif %}
                  {% endif %}

                  {% comment %} 职位信息 {% endcomment %}
                  {% assign position_lines = item.position | split: '<br/>' %}
                  <div class="text-gray-700 mt-1 font-weight-medium">
                    {% for line in position_lines %}
                      {{ line | strip }}
                      {% if forloop.last == false %}
                        <br/>
                      {% endif %}
                    {% endfor %}
                  </div>

                  {% comment %} 导师信息 - 修复了额外逗号的问题 {% endcomment %}
                  {% if item.advisor and item.advisor.size > 0 %}
                    <div class="text-gray-700 mt-1">
                      Advisor:
                      {% comment %} 检查是否是数组格式的advisor {% endcomment %}
                      {% if item.advisor[0].name %}
                        {% for advisor in item.advisor %}
                          {% if forloop.first == false %}, {% endif %}
                          {% if advisor.url and advisor.url != "none" and advisor.url != empty %}
                            <a href="{{ advisor.url | strip }}" class="education-link">{{ advisor.name }}</a>
                          {% else %}
                            {{ advisor.name }}
                          {% endif %}
                        {% endfor %}
                      {% else %}
                        {% comment %} 处理交替name/url的格式 {% endcomment %}
                        {% assign is_name = true %}
                        {% assign advisors = "" | split: '' %}
                        {% for advisor in item.advisor %}
                          {% if is_name and advisor.name %}
                            {% assign current_name = advisor.name %}
                            {% assign is_name = false %}
                          {% elsif advisor.url and advisor.url != "none" and advisor.url != empty %}
                            {% assign advisor_html = '<a href="' | append: advisor.url | strip | append: '" class="education-link">' | append: current_name | append: '</a>' %}
                            {% assign advisors = advisors | push: advisor_html %}
                            {% assign is_name = true %}
                          {% endif %}
                        {% endfor %}

                        {% comment %} 正确显示所有导师，只在中间添加逗号 {% endcomment %}
                        {% for i in (0..advisors.size) %}
                          {% if i < advisors.size %}
                            {{ advisors[i] }}
                            {% if i < advisors.size | minus: 1 %}, {% endif %}
                          {% endif %}
                        {% endfor %}
                      {% endif %}
                    </div>
                  {% endif %}
                </div>
                <div class="text-gray-500 text-sm text-nowrap ml-3 mt-0">{{ item.date }}</div>
              </div>
            </div>
          </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>

<style>
  /* 统一链接样式 - 与网站其他部分保持一致 */
  .education-link {
    color: var(--primary, #0369a1);
    font-weight: 600;
    text-decoration: underline;
    text-decoration-thickness: 1.5px;
    text-underline-offset: 2px;
    transition: all 180ms ease;
  }

  .education-link:hover {
    color: var(--primary-600, #0284c7);
    text-decoration-color: var(--primary-600, #0284c7);
  }

  .education-link:focus {
    outline: none;
    box-shadow: 0 6px 14px rgba(3, 105, 161, 0.12);
  }

  /* Match the publication section heading style */
  .education-heading {
    font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, sans-serif;
    font-weight: 600;
    font-size: 1.125rem;
    line-height: 1.3;
    letter-spacing: -0.025em;
    color: #1e293b;
    padding: 0;
    margin-bottom: 1.25rem;
  }
</style>