<div class="row mt-4">
  <div class="col-12">
    <div class="card border-0 shadow-sm bg-white rounded-xl">
      <div class="card-body p-4">
        <h6 class="mb-4 text-uppercase font-weight-bold text-sm tracking-widest text-primary-700 d-flex align-items-center">
          <svg class="me-2" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <linearGradient id="capGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#0ea5e9;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#0369a1;stop-opacity:1" />
              </linearGradient>
              <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
                <feDropShadow dx="1" dy="1" stdDeviation="1" flood-color="black" flood-opacity="0.2"/>
              </filter>
            </defs>

            <path d="M12 2.5L16.5 5H7.5L12 2.5Z" fill="url(#capGradient)" filter="url(#shadow)"/>
            <path d="M12 2.5L16.5 5H7.5L12 2.5Z" stroke="#0369a1" stroke-width="0.8" stroke-linejoin="round"/>

            <path d="M5.5 11.5L18.5 11.5L21.5 5H2.5L5.5 11.5Z" fill="url(#capGradient)" filter="url(#shadow)"/>
            <path d="M5.5 11.5L18.5 11.5L21.5 5H2.5L5.5 11.5Z" stroke="#0369a1" stroke-width="0.8"/>

            <path d="M7 9.5H17" stroke="white" stroke-width="1" stroke-linecap="round"/>

            <path d="M12 11.5V17" stroke="#dc2626" stroke-width="1.5" stroke-linecap="round"/>

            <circle cx="12" cy="17.5" r="1.5" fill="#ef4444"/>
            <circle cx="12" cy="17.5" r="1.5" fill="white" fill-opacity="0.2"/>
            <path d="M5.5 11.5L18.5 11.5L21.5 5H2.5L5.5 11.5Z" fill="black" fill-opacity="0.1" transform="translate(0.5, 0.5)"/>
          </svg>
          Education
        </h6>
        <ul class="list-unstyled">
          {% for item in site.data.profile.education %}
          <li class="d-flex mb-4 align-items-center">
            <img src="{{ item.logo | relative_url }}" alt="{{ item.name }}" class="w-16 h-16 object-contain mr-4" loading="lazy" style="filter: brightness(0.9);">
            <div class="flex-grow-1">
              <div class="d-flex justify-content-between align-items-start flex-wrap">
                <div>
                  {% comment %} 学校名称 {% endcomment %}
                  <h5 class="mt-0 mb-1 font-weight-bold">
                    {% if item.url %}
                      <a href="{{ item.url | strip }}" class="education-link">{{ item.name }}</a>
                    {% else %}
                      {{ item.name }}
                    {% endif %}
                  </h5>

                  {% comment %} 实验室信息 - 修复了注释和空值问题 {% endcomment %}
                  {% if item.lab %}
                    {% comment %} 处理lab可能是对象或字符串的情况 {% endcomment %}
                    {% if item.lab.name %}
                      {% assign lab_name = item.lab.name %}
                      {% assign lab_url = item.lab.url | default: "" %}
                    {% else %}
                      {% assign lab_name = item.lab %}
                      {% assign lab_url = "" %}
                    {% endif %}

                    {% if lab_name != empty and lab_name != "none" %}
                      <div class="text-gray-700 mb-1">
                        {% if lab_url != empty and lab_url != "none" %}
                          <a href="{{ lab_url | strip }}" class="education-link">{{ lab_name | strip }}</a>
                        {% else %}
                          {{ lab_name | strip }}
                        {% endif %}
                      </div>
                    {% endif %}
                  {% endif %}

                  {% comment %} 职位信息 {% endcomment %}
                  {% assign position_lines = item.position | split: '<br/>' %}
                  <div class="text-gray-700 mt-1 font-weight-medium">
                    {% for line in position_lines %}
                      {{ line | strip }}
                      {% if forloop.last == false %}
                        <br/>
                      {% endif %}
                    {% endfor %}
                  </div>

                  {% comment %} 导师信息 - 修复了额外逗号的问题 {% endcomment %}
                  {% if item.advisor and item.advisor.size > 0 %}
                    <div class="text-gray-700 mt-1">
                      Advisor:
                      {% comment %} 检查是否是数组格式的advisor {% endcomment %}
                      {% if item.advisor[0].name %}
                        {% for advisor in item.advisor %}
                          {% if forloop.first == false %}, {% endif %}
                          {% if advisor.url and advisor.url != "none" and advisor.url != empty %}
                            <a href="{{ advisor.url | strip }}" class="education-link">{{ advisor.name }}</a>
                          {% else %}
                            {{ advisor.name }}
                          {% endif %}
                        {% endfor %}
                      {% else %}
                        {% comment %} 处理交替name/url的格式 {% endcomment %}
                        {% assign is_name = true %}
                        {% assign advisors = "" | split: '' %}
                        {% for advisor in item.advisor %}
                          {% if is_name and advisor.name %}
                            {% assign current_name = advisor.name %}
                            {% assign is_name = false %}
                          {% elsif advisor.url and advisor.url != "none" and advisor.url != empty %}
                            {% assign advisor_html = '<a href="' | append: advisor.url | strip | append: '" class="education-link">' | append: current_name | append: '</a>' %}
                            {% assign advisors = advisors | push: advisor_html %}
                            {% assign is_name = true %}
                          {% endif %}
                        {% endfor %}

                        {% comment %} 正确显示所有导师，只在中间添加逗号 {% endcomment %}
                        {% for i in (0..advisors.size) %}
                          {% if i < advisors.size %}
                            {{ advisors[i] }}
                            {% if i < advisors.size | minus: 1 %}, {% endif %}
                          {% endif %}
                        {% endfor %}
                      {% endif %}
                    </div>
                  {% endif %}
                </div>
                <div class="text-gray-500 text-sm text-nowrap ml-3 mt-0">{{ item.date }}</div>
              </div>
            </div>
          </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>

<style>
  /* 统一链接样式 - 与网站其他部分保持一致 */
  .education-link {
    color: var(--primary, #0369a1);
    font-weight: 600;
    text-decoration: underline;
    text-decoration-thickness: 1.5px;
    text-underline-offset: 2px;
    transition: all 180ms ease;
  }

  .education-link:hover {
    color: var(--primary-600, #0284c7);
    text-decoration-color: var(--primary-600, #0284c7);
  }

  .education-link:focus {
    outline: none;
    box-shadow: 0 6px 14px rgba(3, 105, 161, 0.12);
  }
</style>